{"version":3,"file":"yss.min.js","sources":["src/utils.js","src/render.js","src/helpers.js","src/index.js"],"sourcesContent":["'use strict'\n\nvar KEBAB_REGEX = /[A-Z\\u00C0-\\u00D6\\u00D8-\\u00DE]/g\n\nexport function kebabCase(str) {\n  return str.replace(KEBAB_REGEX, match => `-${match.toLowerCase()}`)\n}\n\nexport function camelize(s) {\n  return s.replace(/-([a-z])/g, g => g[1].toUpperCase())\n}\n\nexport function cleanSplit(s, regExp) {\n  return s\n    .split(regExp)\n    .map(a => a.trim())\n    .filter(a => a)\n}\n\nexport function isObject(thing) {\n  return typeof thing === 'object'\n}\n\nexport function toAlphabetNumber(number) {\n  return number.toString(36)\n}\n\nexport function getClassName(n) {\n  return '.y' + toAlphabetNumber(n)\n}\n\nexport const keys = Object.keys\nexport function map(obj, fn) {\n  return Object.keys(obj).map(key => fn(obj[key], key))\n}\n","'use strict'\n\nimport { kebabCase, map, toAlphabetNumber, keys } from './utils'\n\nfunction isAttr(attr) {\n  return attr[0] !== ':' && attr[0] !== ' ' && attr[0] !== '@'\n}\n\nfunction isSubselector(attr) {\n  return attr[0] === ':' || attr[0] === ' '\n}\n\nfunction isMediaQuery(attr) {\n  return attr[0] === '@'\n}\n\nconst animationNameByStyle = {}\nlet animationCounter = 0\nexport default function(style) {\n  const usedAnimations = {}\n  function toCssDefinition(cssClass, style) {\n    const baseStyle = keys(style)\n      .filter(isAttr)\n      .map(attr => {\n        let value = style[attr]\n        if (attr === 'animation') {\n          const frameStyles = style[attr].frameStyles\n          const animationStyle = map(frameStyles, (y, frameName) =>\n            toCssDefinition(frameName, y.style)\n          ).join('')\n          if (!animationNameByStyle[animationStyle]) {\n            animationNameByStyle[animationStyle] =\n              'a' + toAlphabetNumber(animationCounter++)\n          }\n          usedAnimations[animationStyle] = animationNameByStyle[animationStyle]\n          value = `${style[attr].timing || ''} ${\n            animationNameByStyle[animationStyle]\n          }`\n        }\n        return `${kebabCase(attr)}:${value}`\n      })\n      .join(';')\n    const subStyles = keys(style)\n      .filter(isSubselector)\n      .map(pseudo => toCssDefinition(cssClass + pseudo, style[pseudo].style))\n      .join('')\n    const mediaStyles = keys(style)\n      .filter(isMediaQuery)\n      .map(\n        mediaQuery =>\n          `${mediaQuery}{${toCssDefinition(\n            `${cssClass}`,\n            style[mediaQuery].style\n          )}}`\n      )\n      .join('')\n    return `${cssClass}{${baseStyle}}${subStyles}${mediaStyles}`\n  }\n\n  const styles = keys(style)\n    .map(function(cssClass) {\n      return `${toCssDefinition(cssClass, style[cssClass])}`\n    })\n    .join('')\n  const keyframes = map(\n    usedAnimations,\n    (name, keyframeStyle) => `@keyframes ${name}{${keyframeStyle}}`\n  ).join('')\n  return keyframes + styles\n}\n","'use strict'\n\nexport function nest(y, selector, style) {\n  y.style[` ${selector}`] = y.yss(style)\n}\n\nexport function media(y, def, style) {\n  y.style[`@media ${def}`] = y.yss(style)\n}\n\nexport function animate(y, timing, frameStyles) {\n  y.style.animation = { frameStyles, timing }\n}\n\nexport function pseudo(yss, name, helperName = name) {\n  const selector = `:${name}`\n  yss.helper(helperName, (y, key, ...args) => {\n    if (!y.style[selector] || !y.style[selector].style) {\n      y.style[selector] = yss(y.style[selector])\n    }\n    y.style[selector](key, ...args)\n  })\n}\n","'use strict'\nimport {\n  camelize,\n  cleanSplit,\n  isObject,\n  toAlphabetNumber,\n  getClassName,\n} from './utils'\nimport render from './render'\nimport { nest, media, animate, pseudo } from './helpers'\n\nlet classCounter = 0\nfunction Yss(opts = {}) {\n  const classNamesByStyle = {}\n  opts = Object.assign(\n    {\n      getClassName,\n      render,\n    },\n    opts\n  )\n\n  // this is the prototype of a styling instance.\n  const baseInstance = {\n    get class() {\n      const serializedStyle = JSON.stringify(this.style)\n      const existingClassname = classNamesByStyle[serializedStyle]\n      if (existingClassname) {\n        return existingClassname\n      }\n      const className = opts.getClassName(classCounter++, this.style)\n      classNamesByStyle[serializedStyle] = className\n      yss.style[className] = this.style\n      return className\n    },\n    toString: function() {\n      return this.class\n    },\n    toJSON: function() {\n      return this.style\n    },\n  }\n  Object.setPrototypeOf(baseInstance, function() {})\n\n  function parseStyle(styleInstance, key, ...args) {\n    if (typeof key === 'string' && !args[0]) {\n      // plain string, parse like template string\n      key = [key]\n    }\n    if (Array.isArray(key)) {\n      // template string\n      // fold string array with args\n      const string = key\n        .map((part, i) => part + (args[i] == null ? '' : args[i]))\n        .join('')\n      // build style object\n      return cleanSplit(string, /[;\\n]/).reduce((style, row) => {\n        let [key, ...value] = cleanSplit(row, /[ :]/)\n        const prop = camelize(key)\n        // if there is a helper with prop name, use it\n        if (styleInstance[prop]) {\n          styleInstance[prop](...value)\n        } else {\n          style[prop] = value.join(' ')\n        }\n        return style\n      }, {})\n    }\n    if (key && key.style) {\n      // merge instances\n      return key.style\n    }\n    if (args[0]) {\n      // key/value definition\n      return { [key]: args[0] }\n    }\n    return key // object\n  }\n\n  // this creates a styling instance and hooks the upper prototype to it\n  function yss(...args) {\n    function styleInstance(...styleArgs) {\n      Object.assign(\n        styleInstance.style,\n        parseStyle(styleInstance, ...styleArgs)\n      )\n      return styleInstance\n    }\n    styleInstance.style = {}\n    styleInstance.yss = yss\n    Object.setPrototypeOf(styleInstance, baseInstance)\n    return styleInstance(...args)\n  }\n\n  yss.style = {}\n  Object.defineProperty(yss, 'css', {\n    get: () => opts.render(yss.style),\n  })\n\n  // this is the function to create helpers. Helpers are attached to the prototype of the styling\n  // instances and to yss itself. When called on yss, they automatically create an instance and\n  // and call the helpers on them right away\n  yss.helper = function(name, ...args) {\n    if (isObject(name)) {\n      // define multiple helpers at once\n      const helpers = name\n      for (name in helpers) {\n        yss.helper(name, helpers[name])\n      }\n      return\n    }\n    let fn = args[0]\n    if (\n      typeof args[0] === 'string' ||\n      Array.isArray(args[0]) ||\n      args[0].style\n    ) {\n      fn = y => y(...args)\n    }\n    if (fn.length === 1) {\n      // set to baseInstance\n      Object.defineProperty(baseInstance, name, {\n        get: function() {\n          fn(this)\n          return this\n        },\n      })\n      // set to yss itself\n      Object.defineProperty(yss, name, {\n        // create an instance and call helper right away\n        get: () => yss({})[name],\n      })\n    } else {\n      // set to baseInstance\n      baseInstance[name] = function(...args) {\n        fn(this, ...args)\n        return this\n      }\n      // set to yss itself\n      yss[name] = (...args) => yss({})[name](...args)\n    }\n  }\n\n  // add default helpers\n  yss.helper('nest', nest)\n  yss.helper('media', media)\n  yss.helper('animate', animate)\n  pseudo(yss, 'hover')\n  pseudo(yss, 'focus')\n\n  return yss\n}\n\nexport default Yss\n"],"names":["KEBAB_REGEX","cleanSplit","s","regExp","split","map","a","trim","filter","toAlphabetNumber","number","toString","getClassName","n","const","keys","Object","obj","fn","key","isAttr","attr","isSubselector","isMediaQuery","animationNameByStyle","animationCounter","style","usedAnimations","toCssDefinition","cssClass","baseStyle","let","value","animationStyle","frameStyles","y","frameName","join","timing","str","replace","match","toLowerCase","subStyles","pseudo","mediaStyles","mediaQuery","styles","name","keyframeStyle","nest","selector","yss","media","def","animate","animation","helperName","helper","args","classCounter","opts","classNamesByStyle","assign","render","baseInstance","class","serializedStyle","JSON","stringify","this","existingClassname","className","toJSON","styleInstance","Array","isArray","part","i","reduce","row","prop","g","toUpperCase","camelize","styleArgs","setPrototypeOf","defineProperty","get","thing","isObject","helpers","length","ref"],"mappings":"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"}