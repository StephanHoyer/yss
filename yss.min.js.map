{"version":3,"file":"yss.min.js","sources":["utils.js","render.js","index.js"],"sourcesContent":["'use strict'\n\nvar KEBAB_REGEX = /[A-Z\\u00C0-\\u00D6\\u00D8-\\u00DE]/g\n\nexport function kebabCase(str) {\n  return str.replace(KEBAB_REGEX, match => `-${match.toLowerCase()}`)\n}\n\nexport function camelize(s) {\n  return s.replace(/-([a-z])/g, g => g[1].toUpperCase())\n}\n\nexport function cleanSplit(s, regExp) {\n  return s\n    .split(regExp)\n    .map(a => a.trim())\n    .filter(a => a)\n}\n\nexport function isObject(thing) {\n  return typeof thing === 'object'\n}\n\nconst alphabet =\n  '0123456789qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM_-'\nexport function toAlphabetNumber(number) {\n  const rest = number % alphabet.length\n  const char = alphabet[rest]\n  if (number < alphabet.length) {\n    return char\n  }\n  const quotient = Math.floor(number / alphabet.length)\n  return toAlphabetNumber(quotient) + char\n}\n\nexport function getClassName(n) {\n  return '.y' + toAlphabetNumber(n)\n}\n\nexport const keys = Object.keys\nexport function map(obj, fn) {\n  return Object.keys(obj).map(key => fn(obj[key], key))\n}\n","'use strict'\n\nimport { kebabCase, map, toAlphabetNumber, keys } from './utils'\n\nfunction isAttr(attr) {\n  return attr[0] !== ':' && attr[0] !== ' ' && attr[0] !== '@'\n}\n\nfunction isSubselector(attr) {\n  return attr[0] === ':' || attr[0] === ' '\n}\n\nfunction isMediaQuery(attr) {\n  return attr[0] === '@'\n}\n\nconst animationNameByStyle = {}\nlet animationCounter = 0\nexport default function(style) {\n  const usedAnimations = {}\n  function toCssDefinition(cssClass, style) {\n    const baseStyle = keys(style)\n      .filter(isAttr)\n      .map(attr => {\n        let value = style[attr]\n        if (attr === 'animation') {\n          const frameStyles = style[attr].frameStyles\n          const animationStyle = map(frameStyles, (y, frameName) =>\n            toCssDefinition(frameName, y.style)\n          ).join('')\n          if (!animationNameByStyle[animationStyle]) {\n            animationNameByStyle[animationStyle] =\n              'a' + toAlphabetNumber(animationCounter++)\n          }\n          usedAnimations[animationStyle] = animationNameByStyle[animationStyle]\n          value = `${style[attr].timing || ''} ${\n            animationNameByStyle[animationStyle]\n          }`\n        }\n        return `${kebabCase(attr)}:${value}`\n      })\n      .join(';')\n    const subStyles = keys(style)\n      .filter(isSubselector)\n      .map(pseudo => toCssDefinition(cssClass + pseudo, style[pseudo].style))\n      .join('')\n    const mediaStyles = keys(style)\n      .filter(isMediaQuery)\n      .map(\n        mediaQuery =>\n          `${mediaQuery}{${toCssDefinition(\n            `${cssClass}`,\n            style[mediaQuery].style\n          )}}`\n      )\n      .join('')\n    return `${cssClass}{${baseStyle}}${subStyles}${mediaStyles}`\n  }\n\n  const styles = keys(style)\n    .map(function(cssClass) {\n      return `${toCssDefinition(cssClass, style[cssClass])}`\n    })\n    .join('')\n  const keyframes = map(\n    usedAnimations,\n    (name, keyframeStyle) => `@keyframes ${name}{${keyframeStyle}}`\n  ).join('')\n  return keyframes + styles\n}\n","'use strict'\nimport {\n  camelize,\n  cleanSplit,\n  isObject,\n  toAlphabetNumber,\n  getClassName,\n} from './utils'\nimport render from './render'\n\nlet classCounter = 0\nfunction Yss(opts = {}) {\n  const classNamesByStyle = {}\n  opts = Object.assign(\n    {\n      getClassName,\n      render,\n    },\n    opts\n  )\n\n  // this is the prototype of a styling instance.\n  const baseInstance = {\n    get class() {\n      const serializedStyle = JSON.stringify(this.style)\n      const existingClassname = classNamesByStyle[serializedStyle]\n      if (existingClassname) {\n        return existingClassname\n      }\n      const className = opts.getClassName(classCounter++, this.style)\n      classNamesByStyle[serializedStyle] = className\n      yss.style[className] = this.style\n      return className\n    },\n    toString: function() {\n      return this.class\n    },\n    toJSON: function() {\n      return this.style\n    },\n  }\n  Object.setPrototypeOf(baseInstance, function() {})\n\n  function parseStyle(key, ...args) {\n    if (typeof key === 'string' && !args[0]) {\n      // plain string, parse like template string\n      key = [key]\n    }\n    if (Array.isArray(key)) {\n      // template string\n      // fold string array with args\n      const string = key\n        .map((part, i) => part + (args[i] == null ? '' : args[i]))\n        .join('')\n      // build style object\n      return cleanSplit(string, /[;\\n]/).reduce((style, row) => {\n        let [key, ...value] = cleanSplit(row, /[ :]/)\n        style[camelize(key)] = value.join(' ')\n        return style\n      }, {})\n    }\n    if (key && key.style) {\n      // merge instances\n      return key.style\n    }\n    if (args[0]) {\n      // key/value definition\n      return { [key]: args[0] }\n    }\n    return key // object\n  }\n\n  // this creates a styling instance and hooks the upper prototype to it\n  function yss(...args) {\n    function styleInstance(...styleArgs) {\n      Object.assign(styleInstance.style, parseStyle(...styleArgs))\n      return styleInstance\n    }\n    styleInstance.style = {}\n    Object.setPrototypeOf(styleInstance, baseInstance)\n    return styleInstance(...args)\n  }\n\n  yss.style = {}\n  Object.defineProperty(yss, 'css', {\n    get: () => opts.render(yss.style),\n  })\n\n  // this is the function to create helpers. Helpers are attached to the prototype of the styling\n  // instances and to yss itself. When called on yss, they automatically create an instance and\n  // and call the helpers on them right away\n  yss.helper = function(name, ...args) {\n    if (isObject(name)) {\n      // define multiple helpers at once\n      const helpers = name\n      for (name in helpers) {\n        yss.helper(name, helpers[name])\n      }\n      return\n    }\n    let fn = args[0]\n    if (\n      typeof args[0] === 'string' ||\n      Array.isArray(args[0]) ||\n      args[0].style\n    ) {\n      fn = y => y(...args)\n    }\n    if (fn.length === 1) {\n      // set to baseInstance\n      Object.defineProperty(baseInstance, name, {\n        get: function() {\n          fn(this)\n          return this\n        },\n      })\n      // set to yss itself\n      Object.defineProperty(yss, name, {\n        // create an instance and call helper right away\n        get: () => yss({})[name],\n      })\n    } else {\n      // set to baseInstance\n      baseInstance[name] = function(...args) {\n        fn(this, ...args)\n        return this\n      }\n      // set to yss itself\n      yss[name] = (...args) => yss({})[name](...args)\n    }\n  }\n\n  return yss\n}\n\nexport default Yss\n"],"names":["KEBAB_REGEX","cleanSplit","s","regExp","split","map","a","trim","filter","const","alphabet","toAlphabetNumber","number","rest","length","char","Math","floor","getClassName","n","keys","Object","obj","fn","key","isAttr","attr","isSubselector","isMediaQuery","animationNameByStyle","animationCounter","style","usedAnimations","toCssDefinition","cssClass","baseStyle","let","value","animationStyle","frameStyles","y","frameName","join","timing","replace","match","toLowerCase","subStyles","pseudo","mediaStyles","mediaQuery","styles","name","keyframeStyle","classCounter","opts","classNamesByStyle","assign","render","baseInstance","class","serializedStyle","JSON","stringify","this","existingClassname","className","yss","toString","toJSON","styleInstance","args","Array","isArray","part","i","reduce","row","g","toUpperCase","styleArgs","setPrototypeOf","defineProperty","get","helper","ref","helpers"],"mappings":"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"}