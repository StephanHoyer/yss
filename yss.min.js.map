{"version":3,"file":"yss.min.js","sources":["src/utils.js","src/render.js","src/helpers.js","src/index.js"],"sourcesContent":["'use strict'\n\nvar KEBAB_REGEX = /[A-Z\\u00C0-\\u00D6\\u00D8-\\u00DE]/g\n\nexport function kebabCase(str) {\n  return str.replace(KEBAB_REGEX, match => `-${match.toLowerCase()}`)\n}\n\nexport function camelize(s) {\n  return s.replace(/-([a-z])/g, g => g[1].toUpperCase())\n}\n\nexport function cleanSplit(s, regExp) {\n  return s\n    .split(regExp)\n    .map(a => a.trim())\n    .filter(a => a)\n}\n\nexport function isObject(thing) {\n  return typeof thing === 'object'\n}\n\nconst alphabet =\n  '0123456789qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM_-'\nexport function toAlphabetNumber(number) {\n  const rest = number % alphabet.length\n  const char = alphabet[rest]\n  if (number < alphabet.length) {\n    return char\n  }\n  const quotient = Math.floor(number / alphabet.length)\n  return toAlphabetNumber(quotient) + char\n}\n\nexport function getClassName(n) {\n  return '.y' + toAlphabetNumber(n)\n}\n\nexport const keys = Object.keys\nexport function map(obj, fn) {\n  return Object.keys(obj).map(key => fn(obj[key], key))\n}\n","'use strict'\n\nimport { kebabCase, map, toAlphabetNumber, keys } from './utils'\n\nfunction isAttr(attr) {\n  return attr[0] !== ':' && attr[0] !== ' ' && attr[0] !== '@'\n}\n\nfunction isSubselector(attr) {\n  return attr[0] === ':' || attr[0] === ' '\n}\n\nfunction isMediaQuery(attr) {\n  return attr[0] === '@'\n}\n\nconst animationNameByStyle = {}\nlet animationCounter = 0\nexport default function(style) {\n  const usedAnimations = {}\n  function toCssDefinition(cssClass, style) {\n    const baseStyle = keys(style)\n      .filter(isAttr)\n      .map(attr => {\n        let value = style[attr]\n        if (attr === 'animation') {\n          const frameStyles = style[attr].frameStyles\n          const animationStyle = map(frameStyles, (y, frameName) =>\n            toCssDefinition(frameName, y.style)\n          ).join('')\n          if (!animationNameByStyle[animationStyle]) {\n            animationNameByStyle[animationStyle] =\n              'a' + toAlphabetNumber(animationCounter++)\n          }\n          usedAnimations[animationStyle] = animationNameByStyle[animationStyle]\n          value = `${style[attr].timing || ''} ${\n            animationNameByStyle[animationStyle]\n          }`\n        }\n        return `${kebabCase(attr)}:${value}`\n      })\n      .join(';')\n    const subStyles = keys(style)\n      .filter(isSubselector)\n      .map(pseudo => toCssDefinition(cssClass + pseudo, style[pseudo].style))\n      .join('')\n    const mediaStyles = keys(style)\n      .filter(isMediaQuery)\n      .map(\n        mediaQuery =>\n          `${mediaQuery}{${toCssDefinition(\n            `${cssClass}`,\n            style[mediaQuery].style\n          )}}`\n      )\n      .join('')\n    return `${cssClass}{${baseStyle}}${subStyles}${mediaStyles}`\n  }\n\n  const styles = keys(style)\n    .map(function(cssClass) {\n      return `${toCssDefinition(cssClass, style[cssClass])}`\n    })\n    .join('')\n  const keyframes = map(\n    usedAnimations,\n    (name, keyframeStyle) => `@keyframes ${name}{${keyframeStyle}}`\n  ).join('')\n  return keyframes + styles\n}\n","'use strict'\n\nexport function nest(y, selector, style) {\n  y.style[` ${selector}`] = style\n}\n\nexport function media(y, def, style) {\n  y.style[`@media ${def}`] = style\n}\n\nexport function animate(y, timing, frameStyles) {\n  y.style.animation = { frameStyles, timing }\n}\n\nexport function pseudo(yss, name, helperName = name) {\n  const selector = `:${name}`\n  yss.helper(helperName, (y, key, ...args) => {\n    if (!y.style[selector] || !y.style[selector].style) {\n      y.style[selector] = yss(y.style[selector])\n    }\n    y.style[selector](key, ...args)\n  })\n}\n","'use strict'\nimport {\n  camelize,\n  cleanSplit,\n  isObject,\n  toAlphabetNumber,\n  getClassName,\n} from './utils'\nimport render from './render'\nimport { nest, media, animate, pseudo } from './helpers'\n\nlet classCounter = 0\nfunction Yss(opts = {}) {\n  const classNamesByStyle = {}\n  opts = Object.assign(\n    {\n      getClassName,\n      render,\n    },\n    opts\n  )\n\n  // this is the prototype of a styling instance.\n  const baseInstance = {\n    get class() {\n      const serializedStyle = JSON.stringify(this.style)\n      const existingClassname = classNamesByStyle[serializedStyle]\n      if (existingClassname) {\n        return existingClassname\n      }\n      const className = opts.getClassName(classCounter++, this.style)\n      classNamesByStyle[serializedStyle] = className\n      yss.style[className] = this.style\n      return className\n    },\n    toString: function() {\n      return this.class\n    },\n    toJSON: function() {\n      return this.style\n    },\n  }\n  Object.setPrototypeOf(baseInstance, function() {})\n\n  function parseStyle(key, ...args) {\n    if (typeof key === 'string' && !args[0]) {\n      // plain string, parse like template string\n      key = [key]\n    }\n    if (Array.isArray(key)) {\n      // template string\n      // fold string array with args\n      const string = key\n        .map((part, i) => part + (args[i] == null ? '' : args[i]))\n        .join('')\n      // build style object\n      return cleanSplit(string, /[;\\n]/).reduce((style, row) => {\n        let [key, ...value] = cleanSplit(row, /[ :]/)\n        style[camelize(key)] = value.join(' ')\n        return style\n      }, {})\n    }\n    if (key && key.style) {\n      // merge instances\n      return key.style\n    }\n    if (args[0]) {\n      // key/value definition\n      return { [key]: args[0] }\n    }\n    return key // object\n  }\n\n  // this creates a styling instance and hooks the upper prototype to it\n  function yss(...args) {\n    function styleInstance(...styleArgs) {\n      Object.assign(styleInstance.style, parseStyle(...styleArgs))\n      return styleInstance\n    }\n    styleInstance.style = {}\n    Object.setPrototypeOf(styleInstance, baseInstance)\n    return styleInstance(...args)\n  }\n\n  yss.style = {}\n  Object.defineProperty(yss, 'css', {\n    get: () => opts.render(yss.style),\n  })\n\n  // this is the function to create helpers. Helpers are attached to the prototype of the styling\n  // instances and to yss itself. When called on yss, they automatically create an instance and\n  // and call the helpers on them right away\n  yss.helper = function(name, ...args) {\n    if (isObject(name)) {\n      // define multiple helpers at once\n      const helpers = name\n      for (name in helpers) {\n        yss.helper(name, helpers[name])\n      }\n      return\n    }\n    let fn = args[0]\n    if (\n      typeof args[0] === 'string' ||\n      Array.isArray(args[0]) ||\n      args[0].style\n    ) {\n      fn = y => y(...args)\n    }\n    if (fn.length === 1) {\n      // set to baseInstance\n      Object.defineProperty(baseInstance, name, {\n        get: function() {\n          fn(this)\n          return this\n        },\n      })\n      // set to yss itself\n      Object.defineProperty(yss, name, {\n        // create an instance and call helper right away\n        get: () => yss({})[name],\n      })\n    } else {\n      // set to baseInstance\n      baseInstance[name] = function(...args) {\n        fn(this, ...args)\n        return this\n      }\n      // set to yss itself\n      yss[name] = (...args) => yss({})[name](...args)\n    }\n  }\n\n  // add default helpers\n  yss.helper('nest', nest)\n  yss.helper('media', media)\n  yss.helper('animate', animate)\n  pseudo(yss, 'hover')\n  pseudo(yss, 'focus')\n\n  return yss\n}\n\nexport default Yss\n"],"names":["KEBAB_REGEX","cleanSplit","s","regExp","split","map","a","trim","filter","const","alphabet","toAlphabetNumber","number","rest","length","char","Math","floor","getClassName","n","keys","Object","obj","fn","key","isAttr","attr","isSubselector","isMediaQuery","animationNameByStyle","animationCounter","style","usedAnimations","toCssDefinition","cssClass","baseStyle","let","value","animationStyle","frameStyles","y","frameName","join","timing","replace","match","toLowerCase","subStyles","pseudo","mediaStyles","mediaQuery","styles","name","keyframeStyle","nest","selector","media","def","animate","animation","yss","helperName","helper","args","classCounter","opts","classNamesByStyle","assign","render","baseInstance","class","serializedStyle","JSON","stringify","this","existingClassname","className","toString","toJSON","styleInstance","Array","isArray","part","i","reduce","row","g","toUpperCase","styleArgs","setPrototypeOf","defineProperty","get","ref","helpers"],"mappings":"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"}